#  三种方法 三个指标 K个信噪比 0.05: 0.05 : 0.5

在实验过程中，我们构造了具有不同信噪比的图片训练集，以对比三种去噪方法在不同信噪比下的表现。
信噪比的定义：
图片信噪比是衡量图片中噪声信号与有效信号占比的数值指标，其计算公式如下：


为了构造具有不同信噪比的数据集，我们编写了construct_image_with_SNR函数，用于将洁净的图片image，给定期望的SNR值，计算出对应的噪声强度施加在image上，从而得到噪声图片image。


保存模型

N2N方法的图像对比
10组不同信噪比的图像及其去噪后图片效果对比：

在10组信噪比中，SNR为0.064到0.5的9组图像中，可以识别出蛋白质结构实体的轮廓。
每组图片都由实体部分和底噪部分组成，底噪部分在洁净图片中是像素值严格等于0的点，加上噪声后成为底噪。可以看出，9组图片的实体部分跟底噪部分的对比度都有所增强，说明N2N降噪算法有效地降低了底噪强度，凸显了蛋白质结构实体部分。
在SNR值为0.01的降噪任务中，由于信噪比过低，带噪声图片和降噪后图片都无法清晰辨认实体部分的轮廓，但是可以发现降噪后图片有多处噪声被减弱（颜色越接近黑色代表像素值接近0）。
从蛋白质结构实体看，除开SNR值为0.228和0.01的两组图片，其他实验组均较好地保留了实体的结构细节；尤其SNR值为0.337时，降噪结果相比降噪前保留了更多的细节。在降噪的同时，可以发现每组图片都出现了不同程度上的模糊。其中第7和第9组图片的模糊程度较轻，而第1,2,3组的模糊程度较重，反映出N2N降噪的模糊程度随着SNR值提高而改善。

N2N方法的FRC
为了从FRC的角度衡量降噪效果，我们对每组图片中降噪后图片与洁净图片计算FRC曲线，以对比不同信噪比下图片的去噪效果。

FRC反映的是两张图片在空间频域上的相关性。由于各组实验的图片尺寸一致，因此空间频率域可归一化为范围0到1以方便讨论。一般来说，图片的噪声分量频率较高，降噪后图片仍带有部分噪声，因此预期的FRC曲线将呈现FRC值随空间频率增大而降低的趋势（反映了图片在低频部分一致，在高频噪声部分差异较大的特点）。
为了方便观察，将10组实验的FRC曲线图绘制在两张图片中。
首先观察图一可以发现，当SNR值为0.01时，FRC曲线急速下降，说明N2N算法在此SNR值下降噪效果较差，与肉眼观察结果一致。
第2到9组图片呈现SNR值越大，FRC值越高的趋势；说明在FRC指标下，N2N算法的表现随着SNR值提高而有所改善。其中有部分SNR值较低，但是FRC曲线值较高的图片组（SNR=0.337和SNR=0.119），考虑到图片噪声以及降噪训练过程中有一定随机性，可视为随机干扰的作用。

总结来说，各个实验组基本符合一般FRC曲线的延伸趋势，说明经过N2N是降噪后仍不能完全去除高频噪声分量；当SNR值较大，也即噪声强度较小时，N2N算法降噪结果与洁净图片更加接近。

N2N的CC

|   SNR   |   inp   |     out |
| ---- | ---- | ---- |
|0.01|0.067|0.099|
|0.064|0.399|0.857|
|0.119|0.624|0.877|
|0.173|0.761|0.879|
|0.228|0.839|0.84|
|0.282|0.886|0.876|
|0.337|0.916|0.892|
|0.391|0.936|0.86|
|0.446|0.949|0.87|
|0.5|0.959|0.881|

从互相关系数上看，在前5组图片中，降噪图片相比带噪声图片，与洁净图片的互相关系数更大；当SNR继续增大，带噪声图片与洁净图片的互相关系数更大。同时，随着SNR增大, 噪声图片与洁净图片互相关系数提高；降噪图片与洁净图片互相关系数降低。
对此现象的解释是：经过N2N降噪处理后，蛋白质实体部分经过降噪，像素值发生改变，会破坏部分细节，使得实体部分稍有偏离洁净图片；同时底噪部分也被大大降低，使得底噪部分更加接近洁净图片。当SNR值较小时，噪声大，图片的底噪占主要影响，因此经过降噪后图像与原图更加接近；当SNR值较大是，噪声小，图片的底噪占次要影响，即使N2N有效地降低了底噪，但仍不抵实体部分的影响，因此互相关系数降低。

总体来说，因为一张图片包括空白底噪和实体部分；而互相关系数计算的是单个数值，能从整体上反映两幅图片的差异，但也因此无法正确反映降噪算法对降低底噪的积极作用。

N2N的SSIM


N2V方法的FRC



N2V方法的CC

N2N的SSIM

滤波器的FRC

滤波器的CC

滤波器的SSIM

总结
